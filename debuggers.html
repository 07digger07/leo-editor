

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Debugging with Leo &mdash; Leo 6.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Leo’s Console Gui" href="console-gui.html" />
    <link rel="prev" title="Unit testing with Leo" href="unitTesting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="leo_toc.html" class="icon icon-home"> Leo
          

          
            
            <img src="_static/Leo4-80-border.jpg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="preliminaries.html">Preliminaries</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Downloading, Installing &amp; Running Leo</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cheatsheet.html">Cheat Sheet</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="screencasts.html">Videos about Leo</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="usersguide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="leoandotherprograms.html">Leo and Other Programs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="intermediatetopics.html">Advanced Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coloring.html">Controlling Syntax Coloring</a></li>
<li class="toctree-l2"><a class="reference internal" href="writingPlugins.html">Writing Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="unitTesting.html">Unit testing with Leo</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging with Leo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-g-trace-and-g-pdb">Using g.trace and g.pdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#settings-for-winpdb">Settings for winpdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-scripts-with-winpdb">Debugging scripts with winpdb</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-debug-command">The debug command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-execute-script-command-with-explicit-debugger-breaks">The execute-script command with explicit debugger breaks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="console-gui.html">Leo’s Console Gui</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripting-miscellany.html">A Miscellany of Leo Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html">Exploring Leo’s Code Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="vim-theory.html">Vim Mode: Theory of Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="leonine-world.html">The Leonine World</a></li>
<li class="toctree-l2"><a class="reference internal" href="leo-university.html">Leo University</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="history.html">History of Leo</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="what-is-new.html">What's New</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="slides.html">Slides</a></li>
<li class="toctree-l1"><a class="reference internal" href="leoLinks.html">More Leo Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen-shots.html">Leo screen shots</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="leo_toc.html">Leo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="leo_toc.html">Docs</a> &raquo;</li>
        
          <li><a href="intermediatetopics.html">Advanced Topics</a> &raquo;</li>
        
      <li>Debugging with Leo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="debugging-with-leo">
<h1>Debugging with Leo<a class="headerlink" href="#debugging-with-leo" title="Permalink to this headline">¶</a></h1>
<p>This chapter discusses debugging Python scripts with Leo.
Be aware of the distinction between <strong>Leo-specific</strong> scripts and <strong>general</strong> scripts.
Leo-specific scripts access data in the Leo outline in which they are contained;
general scripts do not.</p>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#using-g-trace-and-g-pdb" id="id1">Using g.trace and g.pdb</a></p></li>
<li><p><a class="reference internal" href="#settings-for-winpdb" id="id2">Settings for winpdb</a></p></li>
<li><p><a class="reference internal" href="#debugging-scripts-with-winpdb" id="id3">Debugging scripts with winpdb</a></p>
<ul>
<li><p><a class="reference internal" href="#the-debug-command" id="id4">The debug command</a></p></li>
<li><p><a class="reference internal" href="#the-execute-script-command-with-explicit-debugger-breaks" id="id5">The execute-script command with explicit debugger breaks</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="using-g-trace-and-g-pdb">
<h2><a class="toc-backref" href="#id1">Using g.trace and g.pdb</a><a class="headerlink" href="#using-g-trace-and-g-pdb" title="Permalink to this headline">¶</a></h2>
<p>Inserting g.trace statements in my Python code is usually my first debugging choice. The g.trace statement prints the name of the function in which the call to g.trace occurs, followed by the value of its arguments. The output of the g.trace goes to the console, so you must <a class="reference external" href="installing.html#running-leo-from-a-console-window">run Leo in a console</a> to use g.trace.</p>
<p>Inserting and deleting g.trace statements is fast, provided that your <a class="reference external" href="FAQ.html#how-can-i-use-leo-to-develop-leo-itself">work flow</a> makes it easy to restart the program under test. As a result, using g.trace statements is similar to setting tracepoints in a debugger, with the advantage that (disabled) tracepoints remain in the source code for future use. You will find many examples of using g.trace throughout Leo’s source code.</p>
<p>My second choice is using g.pdb to set breakpoints for the <a class="reference external" href="https://docs.python.org/3/library/pdb.html">pdb</a> debugger. Pdb uses the console for all interaction, so you must <a class="reference external" href="installing.html#running-leo-from-a-console-window">run Leo in a console</a>. See the <a class="reference external" href="FAQ.html#how-can-i-use-python-s-pdb-debugger-with-leo">FAQ</a> for a discussion of both g.trace and g.pdb.</p>
</div>
<div class="section" id="settings-for-winpdb">
<h2><a class="toc-backref" href="#id2">Settings for winpdb</a><a class="headerlink" href="#settings-for-winpdb" title="Permalink to this headline">¶</a></h2>
<p>The following settings in leoSettings.leo control debugger operation. The settings shown here will be assumed to be in effect throughout this chapter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@string</span> <span class="n">debugger_kind</span> <span class="o">=</span> <span class="n">winpdb</span>
</pre></div>
</div>
<p>This setting controls what debugger the ‘Debug Script’ script button uses. Eventually this setting will control what debugger the debug command uses:: At present the only valid value is ‘winpdb’</p>
<blockquote>
<div><p>&#64;bool write_script_file = True</p>
</div></blockquote>
<p>True: The execute script command writes the script to be executed to a file, then executes the script using Python’s execFile function. The script_file_path setting specifies the path to this file. False (legacy): The execute script command uses Python’s exec command to execute the script.</p>
<p>&#64;string script_file_path = ../test/scriptFile.py</p>
<p>The path to the file to be written by the execute-script command. Notes:</p>
<ul class="simple">
<li><p>This setting has effect only if the write_script_file setting is True.</p></li>
<li><p>Use / as the path delimiter, regardless of platform.</p></li>
<li><p>The default path is ../test/scriptFile.py if no path is given.</p></li>
<li><p>The path starts at g.app.loadDir, so for example ../test/scriptFile.py is equivalent to leo/test/scriptFile.py.</p></li>
<li><p>The filename should end in .py.</p></li>
</ul>
<p>&#64;string debugger_path = None</p>
</div>
<div class="section" id="debugging-scripts-with-winpdb">
<h2><a class="toc-backref" href="#id3">Debugging scripts with winpdb</a><a class="headerlink" href="#debugging-scripts-with-winpdb" title="Permalink to this headline">¶</a></h2>
<p>The following three section discuss three ways of debugging scripts with <a class="reference external" href="http://www.digitalpeers.com/pythondebugger/">winpdb</a>. The first two sections tell how to debug general scripts; the last section tells how to debug Leo-specific scripts.</p>
<p><a class="reference external" href="http://www.digitalpeers.com/pythondebugger/">winpdb</a> and its documentation have been improved recently. For more details, see the <a class="reference external" href="http://www.digitalpeers.com/pythondebugger/embedded.htm">embedded winpdb</a> docs. The discussion of embedded debugging may have been written specifically with Leo in mind.</p>
<div class="section" id="the-debug-command">
<h3><a class="toc-backref" href="#id4">The debug command</a><a class="headerlink" href="#the-debug-command" title="Permalink to this headline">¶</a></h3>
<p>This way of debugging can only be used for general scripts, not leo-specific scripts. The debug command writes the script to scriptFile.py and invokes winpdb. winpdb opens and is already ‘attached’ to the script to be debugged. You can single-step as you like. Leo continues to run, but killing the debugger will also kill Leo.</p>
</div>
<div class="section" id="the-execute-script-command-with-explicit-debugger-breaks">
<h3><a class="toc-backref" href="#id5">The execute-script command with explicit debugger breaks</a><a class="headerlink" href="#the-execute-script-command-with-explicit-debugger-breaks" title="Permalink to this headline">¶</a></h3>
<p>This way of debugging scripts allows winpdb to debug scripts that use c, g and p. A bit more work is needed because winpdb does not start automatically. Here are step-by step instructions:</p>
<ol class="arabic">
<li><p>Insert the following two lines of code at the start of the script to be debugged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rpdb2</span>
<span class="n">rpdb2</span><span class="o">.</span><span class="n">start_embedded_debugger</span><span class="p">(</span><span class="s1">&#39;go&#39;</span><span class="p">,</span><span class="n">fAllowUnencrypted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Execute Leo’s execute-script command (<em>not</em> the debug command). Leo will appear to hang: start_embedded_debugger is waiting for <em>another</em> copy of winpdb to ‘attach’ to the script’s process. The default timeout is 5 minutes, after which an exception gets thrown.</p></li>
<li><p>Start winpdb explicitly by executing something like the following in a console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">/</span><span class="n">Python26</span><span class="o">/</span><span class="n">Scripts</span><span class="o">/</span><span class="n">_winpdb</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">t</span>
</pre></div>
</div>
<p>The -t option tells winpdb that no encoding of password is necessary.
The password is specified in the call to rpdb2.start_embedded_debugger in your script.
In our example, the password is ‘go’.</p>
</li>
<li><p>Use winpdb’s <a class="reference external" href="File:Attach">File:Attach</a> command to attach winpdb to Leo. Specify the password as ‘go’ and you will see the scriptFile.py containing your entire script. You can now execute or single-step through the script. To repeat, c, g and p are defined, so you can debug any script this way.</p></li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="console-gui.html" class="btn btn-neutral float-right" title="Leo’s Console Gui" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="unitTesting.html" class="btn btn-neutral float-left" title="Unit testing with Leo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1997-2019, Edward K. Ream
      <span class="lastupdated">
        Last updated on Jul 13, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>