.. @+leo-ver=5-thin
.. @+node:ekr.20131003040744.18224: * @file basics2.txt
.. @@language rest
.. @@tabwidth -4

.. @+at @rst-options
..  call_docutils=False
..  code_mode=False
..  generate_rst=True
..  http_server_support = False
..  show_organizer_nodes=True
..  show_headlines=True
..  show_leo_directives=True
..  stylesheet_path=..\doc
..  write_intermediate_file = True
..  verbose=True
.. @@c
.. @+all
.. @+node:ekr.20131003040744.18226: ** @rst html\basics2.html
#########################################
Learn Intermediate Leo Topics in One Hour
#########################################

.. |br| raw:: html

   <br />

.. _`Leo's`: http://leoeditor.com/

This tutorial continues `Leo's`_ tutorial. It covers several intermediate
topics and should take less than an hour to complete.

.. contents::
    :depth: 4

.. @+node:ekr.20131004073415.16044: *3* Clones
..  .. index::
    ..  pair: Clone; Tutorial
    
A **clone** is a node that appears in more than one place in a Leo outline.
Clones are marked with a small red arrow in its icon box. 

All clones of a node are actually *the same node*, so any change to one
clone affects all clones. Inserting, moving or deleting any child of a
clone will change all other clones on the screen.
    
Clones are one of Leo's most powerful features.
Clones allow data to be stored in *arbitrarily many* places within an outline.

Please take a few moments to experiment with clones:

- Create a node whose headline is A.
- Ctrl-` (clone-node) clones node A.
- Type some text into the body of A.
- All clones of A now have the same body.
- Insert a node, say B, as a child of any of the A nodes.
- All the A nodes now have a B child.
- See what happens if you clone B.
- See what happens if you insert, delete or move nodes that are children of A.
- When you delete a node's penultimate clone,
  the last clone becomes a regular node again.

.. @+node:ekr.20131004073415.16045: *3* Views
..  .. index::
    ..  pair: Views; Tutorial

Using clones, you can create as many views of your data as you like.

Views gather data for bug fixes, design review or whatever.

To create a new view:

- Create an *ordinary* (non-cloned) node, to represent the view.
  Let's call this the **view node**.

- Clone the nodes from the outline that you want contained in the view.

- "Add" these clones to the view node by moving them so they become children
  of the view node.

- You can also add uncloned nodes to the view node.

It's particularly useful to create a new view for each programming task:

- Add clones of all nodes related to the task to the view node.

- Now you can work on nodes in a single place; the location of the original
  clones doesn't matter.
.. @+node:ekr.20131001100335.15939: *3* Creating documents with reStructuredText
.. _docutils: http://docutils.sourceforge.net
.. _LaTeX: http://www.latex-project.org/
.. _reStructuredText: http://docutils.sourceforge.net/rst.html
.. _Sphinx: http://sphinx.pocoo.org/
.. _`this chapter`: http://leoeditor.com/rstplugin3.html
.. _`Leo's Users Guide`: http://leoeditor.com/leo_toc.html

The rst3 command converts an @rst tree to `reStructedText`_ (rST) and sends
the result to `docutils`_ or `Sphinx`_ for further processing.

With this tool chain, you can easily create HTML, PDF, LaTeX and other
kinds of documents. All of Leo's documentation is written in Sphinx and
processed with the rst3 command to produce HTML files.

In "plain" rST, you denote sections by underlining heading names.
Reorganizing an document is tedious: you have to change the underlining
characters by hand.

In contrast, the rst3 command automatically creates rST sections from
headlines. Reorganizing your document is easy--just reorganize your @rst
tree. You don't have to change rST markup!

The rst3 command provides *many* other capabilities for power users. For
full details, see `this chapter`_ in `Leo's Users Guide`_.
.. @+node:ekr.20131004172324.16075: *3* Autocompletion
Start or stop autocompletions with Alt-1 (toggle-autocompleter)

Leo's autocompletion feature suggests **completions**, text may be valid in
a given point in source code. For example, suppose the cursor follows::

    os.path.os.st
    
The valid completions are all the members of Python's os.path module whose
names start with 'st'. The valid completions appear in a Tab in the Log
Pane.

Leo also shows completions. These completions assume that c is a commander,
g is the leoGlobals object and p is a position.
.. @+node:ekr.20131005040354.16072: *3* Abbreviations & templates
.. @+node:ekr.20131001100335.15941: *3* Scripting Leo
.. @+node:ekr.20131005055603.16077: *4* Leo scripts
Ctrl-B (execute-script) executes the body pane after expanding @others and
section references throughout the tree. The symbols 'c', 'g' and 'p'
are predefined as follows:

- c is the Commander of the outline in which the script is executing.
- g is the leo.core.leoGlobals module.
- p is c.p (the same as c.currentPosition())

These three predefined variables give any Leo script full access to
all methods defined in Leo's source code. Examples::

    c.redraw() # requests redraw of Leo's screen.
    g.es(s) # prints string s to the log window.
    g.app # the singleton instance of the leoApp class.
    g.app.gui # the the singleton instance of the leoGui class.
    g.app.windowList # the list of presently open frames.

    # Returns list of all open commanders
    commanders = [frame.c for frame in g.app.windowList]

For any position p, here are p's getters::

    p.b # p's body text.
    p.h # p's headline.
    p.u # p's uA, the same as p.unknownAttributes.
    p.v # the vnode corresponding to p.
    p2 = p.copy() # p2 is a copy of p.

    # Returning ints:
    
        p.childIndex()
        p.numberOfChildren()
        p.level()

    # Returning bools:
    
        p.hasChildren()
        p.isAncestorOf(v2) # True if v2 is a child, grandchild, etc. of p.
        p.isCloned()
        p.isDirty()
        p.isExpanded()
        p.isMarked()
        p.isVisible()
        p.isVisited()
        
Here are p's most important setters::

    p.b = s  # Sets the body text of p.
    p.h = s  # Sets the headline text of p.
    p.u = aDict # Sets p.u to the given dictionary.

Here is the list of Leo's iterators::

    c.all_nodes             # all vnodes in c.
    c.all_unique_nodes      # all unique vnodes in c.
    c.all_positions         # all positions in c.
    c.all_unique_positions  # all unique positions in c.

    p.children              # all children of p.
    p.following_siblings    # all siblings of p that follow p.
    p.nodes                 # all vnodes in p's subtree.
    p.parents               # all parents of p.
    p.self_and_parents      # p and all parents of p.
    p.siblings              # all siblings of p, including p.
    p.subtree               # all positions in p's subtree, excluding p.
    p.self_and_subtree      # all positions in p's subtree, including p.
    p.unique_nodes          # all unique vnodes in p's subtree.
    p.unique_subtree        # all unique positions in p's subtree.

.. @+node:ekr.20131005055603.16078: *4* Plugins
Scripting plugins is exactly like writing Leo scripts,
except that plugins must compute c, g and p as follows:

**g**::

    import leo.core.leoGlobals as g
    
**c**::

In the top-level init function::

    g.registerHandler(event_name,my_event_handler)

Define event_handler as follows::

    def my_event_handler (kind,keywords):
        c = keywords.get('c'):
        if c:
            ...
   
**p**::

    p = c.p
.. @+node:ekr.20131004073415.16042: *3* Using @first
..  .. index::
    ..  pair: @first; Tutorial

The @first directive forces a lines to appear before the first sentinel of a
external file. For example::

    @first #! /usr/bin/env python
    @first # -*- coding: utf-8 -*-
.. @+node:ekr.20131004073415.16041: *3* Using @path
..  .. index::
    ..  pair: @path; Tutorial

Rather than specifying long paths in @file nodes, you can specify a path in
an ancestor @path node.

For example, suppose three nodes have the following headlines::

    @path a
        @path b
            @file c/d.py

Because of the ancestor @path nodes, the @file node creates the file
a/b/c/d.py

Within @path and @<file> paths, {{exp}} gets evaluated with the following
symbols known: c, g, p, os and sys.  For example::

    @file {{os.path.abspath(os.curdir)}}/abc.py

refers to the file abc.py in (absolute path of) the current directory.
.. @+node:ekr.20131003040744.18225: *3* Using @auto nodes
.. @+node:ekr.20131002055813.15971: *3* Using @button nodes
.. @+node:ekr.20131002055813.15972: *3* Using @test nodes
.. @+node:ekr.20131004083454.16096: *3* @rst-ignore Killing and yanking text
Ctrl-K (kill line)
Ctrl-Y (yank)
Alt-Y (yank-pop)
Alt-Z (zap-to-character)

From Emacs tutorial: to be revised

Killing means to save the removed text, so that it can be yanked
back later someplace else.

Killed text is saved on the kill ring. The kill ring holds the last N
kills, where N is 30 by default, but you can change it to anything you like
by changing the value of the variable kill-ring-max. The kill ring acts
like a fifo when you're killing things (after the 30th kill, kill number
one is gone), but like a ring when you're yanking things back (you can yank
around the ring circularly). kill-ring-max doesn't apply to the amount of
text (in bytes) that can be saved in the kill ring (there's no limit), only
to the number of distinct kills. Characters

C-d delete-char. Deletes the character to the right of (under, if the
    cursor is a block that covers a character) the cursor. DEL
    delete-backward-char. Deletes the character to the left of the cursor.

M-d kill-word. Kills to the end of the word to the right of the cursor
    (forward). M-DEL backward-kill-word. Kills to the beginning of the word
    to the left of the cursor (backward).

Lines (vertically) It doesn't seem too intuitive to kill lines vertically
by analogy with C-n and C-p; I know of no such commands. Lines
(horizontally)

C-k kill-line. Kills to the end of the current line, not including the
    newline. Thus, if you're at the beginning of a line it takes two C-k's
    to kill the whole line and close up the whitespace. C-u 0 C-k
    kill-line. Kills to the beginning of the current line, not including
    the newline.

You might think that C-u -1 C-k would be used to kill to the beginning of
the line, and it does, but it includes the newline before the line as well.
Sentences

M-k kill-sentence. Kills to the end of the current sentence, including any
    newline within the sentence. C-u -1 M-k kill-sentence. Kills to the
    beginning of the current sentence, including any newlines within the
    sentence.

Paragraphs The commands forward-kill-paragraph and backward-kill-paragraph
exist, but are not bound to any keys by default. Pages There are no
commands to kill pages (but see The Mark and the Region). Buffers The
command kill-buffer doesn't kill all the text in the buffer, but rather the
entire buffer data structure; see The Mark and the Region. S-Expressions
(balanced parentheses)

C-M-k kill-sexp. Kills the sexp after the cursor. C-u -1 C-M-k kill-sexp.
    Kills the sexp before the cursor.

The command backward-kill-sexp exists, but is not bound to any key by
default. Functions There are no commands to kill functions (defuns) (but
see The Mark and the Region). Extending Kills If you kill several times in
a row, with any combination of kill commands, but without any non-kill
commands in between, these kills are appended together in one entry on the
kill ring. For example you can kill a block of text as several lines by
saying C-u 6 C-k, which kills (as one kill) 6 lines. Yanking Once you've
killed some text, how do you get it back? You can yank back the most
recently killed text with C-y (yank). Since Emacs has only one kill ring
(as opposed to one per buffer), you can kill in one buffer, switch to
another and yank the text there.

To get back previous kills, you move around the kill ring. Start with C-y
to get the most recent kill, and then use M-y to move to the previous spot
in the kill ring by replacing the just-yanked text with the previous kill.
Subsequent M-y's move around the ring, each time replacing the yanked text.
When you reach the text you you're interested in, just stop. Any other
command (a motion command, self-insert, anything) breaks the cycling of the
kill ring, and the next C-y yanks the most recent kill again.
.. @+node:ekr.20131002055813.19038: *3* Reference: Moving the cursor
You may override the default key bindings in leoSettings.leo with
@shortcuts nodes in your myLeoSettings.leo file.

**Remember**, all @shortcuts nodes must be descendants of an @settings
node.

**Note**: you may use as many @shortcuts nodes as you like to organize your
bindings.

For example, to bind back-char command to Ctrl-B, add this line to the body
text of one of your @shortcuts nodes::

    back-char = Ctrl-B

Here are the commands that move the cursor, with their default bindings, if
any.

Execute commands without bindings using the minibuffer, as usual.

+----------------------+--------------------------------------+
| Binding              | Command                              |
+======================+======================================+
|                      | **Move by characters**               |
+----------------------+--------------------------------------+
| Left-Arrow           | back-char                            |
+----------------------+--------------------------------------+
| Right-Arrow          | forward-char                         |
+----------------------+--------------------------------------+
| Shift-Right-Arrow    | forward-char-extend-selection        |
+----------------------+--------------------------------------+
| Shift-Left-Arrow     | back-char-extend-selection           |
+----------------------+--------------------------------------+
|                      | **Move by words**                    |
+----------------------+--------------------------------------+
| Ctrl-Left            | back-word                            |
+----------------------+--------------------------------------+
| Ctrl-Right           | forward-word                         |
+----------------------+--------------------------------------+
| Shift-Ctrl-Left      | back-word-extend-selection           |
+----------------------+--------------------------------------+
| Shift-Ctrl-Right     | forward-word-extend-selection        |
+----------------------+--------------------------------------+
|                      | **Move by lines**                    |
+----------------------+--------------------------------------+
| Down-Arrow           | next-line                            |
+----------------------+--------------------------------------+
| End                  | end-of-line                          |
+----------------------+--------------------------------------+
| Home                 | beginning-of-line                    |
+----------------------+--------------------------------------+
| Shift-Down-Arrow     | next-line-extend-selection           |
+----------------------+--------------------------------------+
| Shift-End            | end-of-line-extend-selection         |
+----------------------+--------------------------------------+
| Shift-Home           | beginning-of-line-extend-selection   |
+----------------------+--------------------------------------+
| Shift-Up-Arrow       | previous-line-extend-selection       |
+----------------------+--------------------------------------+
| Up-Arrow             | previous-line                        |
+----------------------+--------------------------------------+
|                      | **Move by sentences**                |
+----------------------+--------------------------------------+
| None                 | backward-sentence                    |
+----------------------+--------------------------------------+
| None                 | backward-sentence-extend-selection   |
+----------------------+--------------------------------------+
| None                 | forward-sentence                     |
+----------------------+--------------------------------------+
| None                 | forward-sentence-extend-selection    |
+----------------------+--------------------------------------+
|                      | **Move by paragraphs**               |
+----------------------+--------------------------------------+
| None                 | backward-paragraph                   |
+----------------------+--------------------------------------+
| None                 | backward-paragraph-extend-selection  |
+----------------------+--------------------------------------+
| Alt-{                | forward-paragraph                    |
+----------------------+--------------------------------------+
| Alst-Shift-{         | forward-paragraph-extend-selection   |
+----------------------+--------------------------------------+
|                      | **Move by pages**                    |
+----------------------+--------------------------------------+
| PageDown             | forward-page                         |
+----------------------+--------------------------------------+
| PageUp               | backward-page                        |
+----------------------+--------------------------------------+
| Shift-PageDown       | forward-page-extend-selection        |
+----------------------+--------------------------------------+
| Shift-PageUp         | backward-page-extend-selection       |
+----------------------+--------------------------------------+
|                      | **Move to start/end of buffer**      |
+----------------------+--------------------------------------+
| Ctrl-End             | end-of-buffer                        |
+----------------------+--------------------------------------+
| Ctrl-Home            | beginning-of-buffer                  |
+----------------------+--------------------------------------+
| Shift-Ctrl-End       | end-of-buffer-extend-selection       |
+----------------------+--------------------------------------+
| Shift-Ctrl-Home      | beginning-of-buffer-extend-selection |
+----------------------+--------------------------------------+
.. @+node:ekr.20131004191204.16077: *3* Reference: Frequently used commands
Except for cursor-moving bindings, here are the key bindings I use on a
regular basis::

    Backspace (backward-delete-character)
    Ctrl-Backspace (backward-delete-word)
    Delete (delete-character)
    Ctrl-Delete (delete-word)
    Tab (newline-and-indent) indents selected lines
    Shift-Tab (unindent-region) unindents selected lines
    Alt-0 (vr-toggle)
    Alt-1 (toggle-autocompleter)
    Alt-8 (goto-last-sibling)
    Alt-A (sort-siblings)
    Alt-G (goto-global-line)
    Alt-R (isearch-backward)
    Alt-S (isearch-forward)
    Alt-T (focus-to-tree)
    Alt-Y (yank-pop)
    Alt-Z (zap-to-character)
    Alt-minus (contract-all)
    Alt-/ (dabbrev-expands) Powerful!
    Ctrl-A (select-all)
    Ctrl-B (execute-script)
    Ctrl-C (copy-text)
    Ctrl-D (move-outline-down)
    Ctrl-F (search-with-present-options)
    Ctrl-G (keyboard-quit)
    Ctrl-H (edit-headline)
    Ctrl-I(insert-node)
    Ctrl-K (kill-line)
    Ctrl-L (move-outline-left) 
    Ctrl-M (mark)
    Ctrl-N (new)
    Ctrl-O (open-outline)
    Ctrl-P (repeat-complex-command) Useful!
    Ctrl-Q (exit-leo)
    Ctrl-R (move-outline-right) 
    Ctrl-S (save-file)
    Ctrl-U (move-outline-up) 
    Ctrl-V (paste-text)
    Ctrl-W (extend-to-word)
    Ctrl-X (cut-text)
    Ctrl-Y (yank)
    Ctrl-Z (undo)
    Ctrl-{ (promote) 
    Ctrl-} (demote) 
    Ctrl-( (add-comments)
    Ctrl-) (delete-comments)
    Ctrl-Shift-C (copy-node)
    Ctrl-Shift-D (extract)
    Ctrl-Shift-P (reformat-paragraph)
    Ctrl-Shift-V (paste-node)
    Ctrl-Shift-W (write-at-file-nodes)
    Ctrl-Shift-X (cut-node)
    Ctrl-Shift-Z (redo)
    Alt+Ctrl+A toggle-find-wrap-around-option
    Alt+Ctrl+B toggle-find-in-body-option
    Alt+Ctrl+C toggle-find-mark-changes-option
    Alt+Ctrl+E set-find-everywhere
    Alt+Ctrl+F toggle-find-mark-finds-option
    Alt+Ctrl+H toggle-find-in-headline-option
    Alt+Ctrl+I toggle-find-ignore-case-option
    Alt+Ctrl+N set-find-node-only
    Alt+Ctrl+S set-find-suboutline-only
    Alt+Ctrl+W toggle-find-word-option
    Alt+Ctrl+X toggle-find-regex-option
    F11 (help-for-command)
    F12 (help-for-python)

These useful commands have no default key bindings::

    beautify
    convert-all-tabs
    convert-tabs
    print-commands: shows alternative bindings
    run-all-unit-tests-locally
    sort-lines
.. @-all
.. @-leo
